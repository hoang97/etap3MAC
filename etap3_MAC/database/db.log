/*C4*/SET SCHEMA PUBLIC
CREATE TABLE IF NOT EXISTS AL_CONFIGURATION ( PROPERTY_NAME VARCHAR(255) NOT NULL UNIQUE , PROPERTY_VALUE LONGVARCHAR ) 
CREATE TABLE IF NOT EXISTS AL_GROUPS ( GROUP_NAME VARCHAR(255) NOT NULL PRIMARY KEY , DESCRIPTION LONGVARCHAR ) 
CREATE TABLE IF NOT EXISTS AL_TABLES ( TABLE_NAME VARCHAR(255) NOT NULL PRIMARY KEY , GROUP_NAME VARCHAR(255) , DESCRIPTION LONGVARCHAR ) 
CREATE TABLE IF NOT EXISTS AL_CUSTOM_TYPE ( TABLE_NAME VARCHAR(255) , COLUMN_NAME VARCHAR(255) , TYPE VARCHAR(255) , NAME VARCHAR(255) ) 
CREATE TABLE IF NOT EXISTS AL_VIEWS ( VIEW_NAME VARCHAR(255) NOT NULL UNIQUE , VIEW_DEFINITION LONGVARCHAR , IS_VALID BOOLEAN ) 
CREATE TABLE IF NOT EXISTS AL_SELECTED_LOG_OBJECTS ( NAME VARCHAR(255) NOT NULL UNIQUE , TYPE VARCHAR(255) ) 
CREATE TABLE IF NOT EXISTS AL_DB_OBJECTS ( NAME VARCHAR(255) NOT NULL UNIQUE , TYPE VARCHAR(255) , USAGE VARCHAR(255) ) 
DELETE FROM S_FLOW WHERE AL_ID=64
DELETE FROM S_FLOW WHERE AL_ID=65
INSERT INTO S_FLOW VALUES(66,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456)
INSERT INTO S_FLOW VALUES(67,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456)
COMMIT
DELETE FROM S_FLOW WHERE AL_ID=66
DELETE FROM S_FLOW WHERE AL_ID=67
INSERT INTO S_FLOW VALUES(68,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456)
INSERT INTO S_FLOW VALUES(69,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456)
COMMIT
DROP TABLE database CASCADE 
DELETE FROM AL_TABLES WHERE TABLE_NAME='database'
COMMIT
DROP TABLE s_flow CASCADE 
DELETE FROM AL_TABLES WHERE TABLE_NAME='s_flow'
COMMIT
CREATE TABLE s_flow ( al_id INT IDENTITY , src_ip LONGVARCHAR NULL , dst_ip LONGVARCHAR NULL , src_mac LONGVARCHAR NULL , dst_mac LONGVARCHAR NULL , src_port INTEGER NULL , dst_port INTEGER NULL , in_port INTEGER NULL , out_port INTEGER NULL , ipprotocol INTEGER NULL , sample_packet_size INTEGER NULL , udpbytes INTEGER NULL , tcpflags LONGVARCHAR NULL , time INTEGER NULL , resutl_average INTEGER NULL , result_volume INTEGER NULL , result_cluster INTEGER NULL , result_logic INTEGER NULL , result INTEGER NULL ) 
INSERT INTO AL_TABLES VALUES('s_flow',NULL,'')
COMMIT
/*C5*/SET SCHEMA PUBLIC
INSERT INTO S_FLOW VALUES(0,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
INSERT INTO S_FLOW VALUES(1,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
COMMIT
DISCONNECT
/*C4*/CREATE TABLE trusted_database ( al_id INT IDENTITY , src_ip LONGVARCHAR NULL , src_mac LONGVARCHAR NULL ) 
INSERT INTO AL_TABLES VALUES('trusted_database',NULL,'')
COMMIT
/*C6*/SET SCHEMA PUBLIC
INSERT INTO TRUSTED_DATABASE VALUES(0,'1.2.3.4','10:10:10:10:10:10')
COMMIT
DISCONNECT
/*C4*/DROP TABLE trusted_database CASCADE 
DELETE FROM AL_TABLES WHERE TABLE_NAME='trusted_database'
COMMIT
CREATE TABLE trusted_database ( al_id INT IDENTITY , src_ip LONGVARCHAR NULL , src_mac LONGVARCHAR NULL ) 
INSERT INTO AL_TABLES VALUES('trusted_database',NULL,'')
COMMIT
CREATE TABLE threats_database ( al_id INT IDENTITY , src_ip LONGVARCHAR NULL , src_mac LONGVARCHAR NULL ) 
INSERT INTO AL_TABLES VALUES('threats_database',NULL,'')
COMMIT
/*C7*/SET SCHEMA PUBLIC
INSERT INTO TRUSTED_DATABASE VALUES(0,'1.2.3.4','10:10:10:10:10:10')
COMMIT
INSERT INTO THREATS_DATABASE VALUES(0,'192.168.10.1','1.1.1.1.1.1')
COMMIT
DISCONNECT
/*C4*/DROP TABLE s_flow CASCADE 
DELETE FROM AL_TABLES WHERE TABLE_NAME='s_flow'
COMMIT
CREATE TABLE s_flow ( al_id INT IDENTITY , src_ip LONGVARCHAR NULL , dst_ip LONGVARCHAR NULL , src_mac LONGVARCHAR NULL , dst_mac LONGVARCHAR NULL , src_port INTEGER NULL , dst_port INTEGER NULL , in_port INTEGER NULL , out_port INTEGER NULL , ipprotocol INTEGER NULL , sample_packet_size INTEGER NULL , udpbytes INTEGER NULL , tcpflags LONGVARCHAR NULL , time INTEGER NULL , result_average INTEGER NULL , result_volume INTEGER NULL , result_cluster INTEGER NULL , result_logic INTEGER NULL , result INTEGER NULL ) 
INSERT INTO AL_TABLES VALUES('s_flow',NULL,'')
COMMIT
/*C8*/SET SCHEMA PUBLIC
INSERT INTO S_FLOW VALUES(0,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
INSERT INTO S_FLOW VALUES(1,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
COMMIT
DISCONNECT
/*C9*/SET SCHEMA PUBLIC
DELETE FROM S_FLOW WHERE AL_ID=0
DELETE FROM S_FLOW WHERE AL_ID=1
INSERT INTO S_FLOW VALUES(2,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
INSERT INTO S_FLOW VALUES(3,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
COMMIT
DELETE FROM TRUSTED_DATABASE WHERE AL_ID=0
INSERT INTO TRUSTED_DATABASE VALUES(1,'1.2.3.4','10:10:10:10:10:10')
COMMIT
DELETE FROM THREATS_DATABASE WHERE AL_ID=0
INSERT INTO THREATS_DATABASE VALUES(1,'192.168.10.1','1.1.1.1.1.1')
COMMIT
DISCONNECT
/*C10*/SET SCHEMA PUBLIC
DELETE FROM S_FLOW WHERE AL_ID=2
DELETE FROM S_FLOW WHERE AL_ID=3
INSERT INTO S_FLOW VALUES(4,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
INSERT INTO S_FLOW VALUES(5,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
COMMIT
DELETE FROM TRUSTED_DATABASE WHERE AL_ID=1
INSERT INTO TRUSTED_DATABASE VALUES(2,'1.2.3.4','10:10:10:10:10:10')
COMMIT
DELETE FROM THREATS_DATABASE WHERE AL_ID=1
INSERT INTO THREATS_DATABASE VALUES(2,'192.168.10.1','1.1.1.1.1.1')
COMMIT
DISCONNECT
/*C11*/SET SCHEMA PUBLIC
DELETE FROM S_FLOW WHERE AL_ID=4
DELETE FROM S_FLOW WHERE AL_ID=5
INSERT INTO S_FLOW VALUES(6,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
INSERT INTO S_FLOW VALUES(7,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
COMMIT
DELETE FROM TRUSTED_DATABASE WHERE AL_ID=2
INSERT INTO TRUSTED_DATABASE VALUES(3,'1.2.3.4','10:10:10:10:10:10')
COMMIT
DELETE FROM THREATS_DATABASE WHERE AL_ID=2
INSERT INTO THREATS_DATABASE VALUES(3,'192.168.10.1','1.1.1.1.1.1')
COMMIT
DISCONNECT
/*C12*/SET SCHEMA PUBLIC
DELETE FROM S_FLOW WHERE AL_ID=6
DELETE FROM S_FLOW WHERE AL_ID=7
INSERT INTO S_FLOW VALUES(8,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
INSERT INTO S_FLOW VALUES(9,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
COMMIT
DELETE FROM TRUSTED_DATABASE WHERE AL_ID=3
INSERT INTO TRUSTED_DATABASE VALUES(4,'1.2.3.4','10:10:10:10:10:10')
COMMIT
DELETE FROM THREATS_DATABASE WHERE AL_ID=3
INSERT INTO THREATS_DATABASE VALUES(4,'192.168.10.1','1.1.1.1.1.1')
COMMIT
DISCONNECT
/*C13*/SET SCHEMA PUBLIC
DELETE FROM S_FLOW WHERE AL_ID=8
DELETE FROM S_FLOW WHERE AL_ID=9
INSERT INTO S_FLOW VALUES(10,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
INSERT INTO S_FLOW VALUES(11,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
COMMIT
DISCONNECT
/*C14*/SET SCHEMA PUBLIC
DELETE FROM S_FLOW WHERE AL_ID=10
DELETE FROM S_FLOW WHERE AL_ID=11
INSERT INTO S_FLOW VALUES(12,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
INSERT INTO S_FLOW VALUES(13,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
COMMIT
DISCONNECT
/*C15*/SET SCHEMA PUBLIC
DELETE FROM S_FLOW WHERE AL_ID=12
DELETE FROM S_FLOW WHERE AL_ID=13
INSERT INTO S_FLOW VALUES(14,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
INSERT INTO S_FLOW VALUES(15,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
COMMIT
DELETE FROM TRUSTED_DATABASE WHERE AL_ID=4
INSERT INTO TRUSTED_DATABASE VALUES(5,'1.2.3.4','10.10.10.10.10.10')
COMMIT
DELETE FROM THREATS_DATABASE WHERE AL_ID=4
INSERT INTO THREATS_DATABASE VALUES(5,'192.168.10.1','1.1.1.1.1.1')
COMMIT
DISCONNECT
/*C16*/SET SCHEMA PUBLIC
DELETE FROM S_FLOW WHERE AL_ID=14
DELETE FROM S_FLOW WHERE AL_ID=15
INSERT INTO S_FLOW VALUES(16,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
INSERT INTO S_FLOW VALUES(17,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
COMMIT
DISCONNECT
/*C17*/SET SCHEMA PUBLIC
DELETE FROM S_FLOW WHERE AL_ID=16
DELETE FROM S_FLOW WHERE AL_ID=17
INSERT INTO S_FLOW VALUES(18,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
INSERT INTO S_FLOW VALUES(19,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
COMMIT
DISCONNECT
/*C18*/SET SCHEMA PUBLIC
DELETE FROM S_FLOW WHERE AL_ID=18
DELETE FROM S_FLOW WHERE AL_ID=19
INSERT INTO S_FLOW VALUES(20,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
INSERT INTO S_FLOW VALUES(21,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
COMMIT
DISCONNECT
/*C4*/DROP TABLE threats_database CASCADE 
DELETE FROM AL_TABLES WHERE TABLE_NAME='threats_database'
COMMIT
DROP TABLE trusted_database CASCADE 
DELETE FROM AL_TABLES WHERE TABLE_NAME='trusted_database'
COMMIT
CREATE TABLE threats_database ( al_id INT IDENTITY , src_ip LONGVARCHAR NULL , src_mac LONGVARCHAR NULL ) 
INSERT INTO AL_TABLES VALUES('threats_database',NULL,'')
COMMIT
CREATE TABLE trusted_database ( al_id INT IDENTITY , src_ip LONGVARCHAR NULL , src_mac LONGVARCHAR NULL ) 
INSERT INTO AL_TABLES VALUES('trusted_database',NULL,'')
COMMIT
/*C19*/SET SCHEMA PUBLIC
INSERT INTO THREATS_DATABASE VALUES(0,'192.168.10.1','1.1.1.1.1.1')
COMMIT
INSERT INTO TRUSTED_DATABASE VALUES(0,'1.2.3.4','10.10.10.10.10.10')
COMMIT
DISCONNECT
/*C20*/SET SCHEMA PUBLIC
DELETE FROM S_FLOW WHERE AL_ID=20
DELETE FROM S_FLOW WHERE AL_ID=21
INSERT INTO S_FLOW VALUES(22,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
INSERT INTO S_FLOW VALUES(23,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
COMMIT
DELETE FROM TRUSTED_DATABASE WHERE AL_ID=0
INSERT INTO TRUSTED_DATABASE VALUES(1,'1.2.3.4','10.10.10.10.10.10')
COMMIT
DELETE FROM THREATS_DATABASE WHERE AL_ID=0
INSERT INTO THREATS_DATABASE VALUES(1,'192.168.10.1','1.1.1.1.1.1')
COMMIT
DISCONNECT
/*C21*/SET SCHEMA PUBLIC
DELETE FROM S_FLOW WHERE AL_ID=22
DELETE FROM S_FLOW WHERE AL_ID=23
INSERT INTO S_FLOW VALUES(24,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
INSERT INTO S_FLOW VALUES(25,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
COMMIT
DELETE FROM TRUSTED_DATABASE WHERE AL_ID=1
INSERT INTO TRUSTED_DATABASE VALUES(2,'1.2.3.4','10.10.10.10.10.10')
COMMIT
DELETE FROM THREATS_DATABASE WHERE AL_ID=1
INSERT INTO THREATS_DATABASE VALUES(2,'192.168.10.1','1.1.1.1.1.1')
COMMIT
DISCONNECT
/*C22*/SET SCHEMA PUBLIC
DELETE FROM S_FLOW WHERE AL_ID=24
DELETE FROM S_FLOW WHERE AL_ID=25
INSERT INTO S_FLOW VALUES(26,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
INSERT INTO S_FLOW VALUES(27,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
COMMIT
DELETE FROM TRUSTED_DATABASE WHERE AL_ID=2
INSERT INTO TRUSTED_DATABASE VALUES(3,'1.2.3.4','10.10.10.10.10.10')
COMMIT
DELETE FROM THREATS_DATABASE WHERE AL_ID=2
INSERT INTO THREATS_DATABASE VALUES(3,'192.168.10.1','1.1.1.1.1.1')
COMMIT
DISCONNECT
/*C23*/SET SCHEMA PUBLIC
DELETE FROM S_FLOW WHERE AL_ID=26
DELETE FROM S_FLOW WHERE AL_ID=27
INSERT INTO S_FLOW VALUES(28,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
INSERT INTO S_FLOW VALUES(29,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
COMMIT
DELETE FROM TRUSTED_DATABASE WHERE AL_ID=3
INSERT INTO TRUSTED_DATABASE VALUES(4,'1.2.3.4','10.10.10.10.10.10')
COMMIT
DELETE FROM THREATS_DATABASE WHERE AL_ID=3
INSERT INTO THREATS_DATABASE VALUES(4,'192.168.10.1','1.1.1.1.1.1')
COMMIT
DISCONNECT
/*C24*/SET SCHEMA PUBLIC
DELETE FROM S_FLOW WHERE AL_ID=28
DELETE FROM S_FLOW WHERE AL_ID=29
INSERT INTO S_FLOW VALUES(30,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
INSERT INTO S_FLOW VALUES(31,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
COMMIT
DELETE FROM TRUSTED_DATABASE WHERE AL_ID=4
INSERT INTO TRUSTED_DATABASE VALUES(5,'1.2.3.4','10.10.10.10.10.10')
COMMIT
DELETE FROM THREATS_DATABASE WHERE AL_ID=4
INSERT INTO THREATS_DATABASE VALUES(5,'192.168.10.1','1.1.1.1.1.1')
COMMIT
DISCONNECT
/*C25*/SET SCHEMA PUBLIC
DELETE FROM S_FLOW WHERE AL_ID=30
DELETE FROM S_FLOW WHERE AL_ID=31
INSERT INTO S_FLOW VALUES(32,'192.168.1.10','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
INSERT INTO S_FLOW VALUES(33,'1.2.3.4','192.168.1.4','10:10:10:10:10:10','AB:AB:AB:AB:AB:AB',1,1,1,2,17,123,123,'ACK',123456,0,0,0,0,0)
COMMIT
DELETE FROM TRUSTED_DATABASE WHERE AL_ID=5
INSERT INTO TRUSTED_DATABASE VALUES(6,'1.2.3.4','10.10.10.10.10.10')
COMMIT
DELETE FROM THREATS_DATABASE WHERE AL_ID=5
INSERT INTO THREATS_DATABASE VALUES(6,'192.168.10.1','1.1.1.1.1.1')
COMMIT
DISCONNECT
